<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monster Energy Presentation</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji';
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-color: #1a1a1a; /* Dark background for energetic theme */
    color: #e0e0e0; /* Light text for high contrast */
    overflow: hidden; /* Hide scrollbars on body */
  }

  .presentation-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100vh;
  }

  .slide {
    background-color: #2b2b2b; /* Slightly lighter dark for slide background */
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    padding: 40px 60px;
    margin: 20px;
    width: 80%;
    max-width: 900px; /* Ensures slide is wider than it is long on common aspect ratios */
    height: auto;
    max-height: 70vh; /* Limits vertical size, ensuring it's not full screen */
    display: none; /* Hidden by default */
    flex-direction: column;
    justify-content: center;
    align-items: flex-start; /* Align content to the left */
    box-sizing: border-box;
    overflow-y: auto; /* Allow scrolling within the slide if content is too long */
    scroll-behavior: smooth; /* Smooth scroll for internal content */
  }

  .slide.active {
    display: flex; /* Display the active slide */
  }

  h1 {
    color: #00e676; /* Vibrant green for headings, energetic style */
    margin-top: 0;
    margin-bottom: 30px;
    font-size: 2.5em;
    text-align: center;
    width: 100%; /* Center the title */
  }

  ul {
    list-style: none; /* Remove default bullets */
    padding-left: 0;
    margin-left: 0;
    width: 100%;
  }

  li {
    margin-bottom: 15px;
    font-size: 1.2em;
    line-height: 1.5;
    display: flex;
    align-items: flex-start;
  }

  /* Bar Chart Specific Styles */
  .bar-chart {
    width: 100%;
    margin-top: 30px;
    display: flex;
    flex-direction: column;
    gap: 15px; /* Space between bar rows */
    min-height: 200px; /* Ensure chart container has a minimum visual presence */
  }

  .bar-row {
    display: flex;
    align-items: center;
    font-size: 1.1em;
  }

  .bar-label {
    flex-shrink: 0; /* Prevent label from shrinking */
    width: 150px; /* Fixed width for consistent label alignment */
    margin-right: 15px;
    text-align: right;
    font-weight: bold;
    color: #a0a0a0; /* Muted color for labels */
  }

  .bar-track {
    flex-grow: 1; /* Track fills the available space */
    background-color: #444; /* Neutral dark background for the track */
    height: 28px;
    border-radius: 4px;
    overflow: hidden; /* Ensures the fill stays within the track's bounds */
    display: flex; /* Allows value to be inside the fill */
  }

  .bar-fill {
    background-color: #00e676; /* Vibrant green accent color for the bar fill */
    height: 100%;
    border-radius: 4px;
    display: flex;
    justify-content: flex-end; /* Align value to the right of the fill */
    align-items: center;
    padding-right: 10px; /* Spacing for the value */
    box-sizing: border-box;
    min-width: 0%; /* Initial state for animation */
    transition: width 0.8s ease-out; /* Smooth animation for width changes */
  }

  .bar-value {
    color: #1a1a1a; /* Dark text on vibrant fill for high contrast */
    font-weight: bold;
    font-size: 0.9em;
    white-space: nowrap; /* Prevent the value from wrapping */
  }

  /* Navigation Buttons */
  .navigation-buttons {
    margin-top: 20px;
    display: flex;
    gap: 20px;
    position: absolute; /* Position buttons relative to viewport */
    bottom: 30px; /* Place at the bottom of the screen */
  }

  .nav-button {
    background-color: #00e676; /* Vibrant green button */
    color: #1a1a1a; /* Dark text on button */
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.1em;
    font-weight: bold;
    transition: background-color 0.3s ease, transform 0.2s ease;
    box-shadow: 0 4px 10px rgba(0, 230, 118, 0.3); /* Subtle glow */
  }

  .nav-button:hover:not(:disabled) {
    background-color: #00c262; /* Slightly darker green on hover */
    transform: translateY(-2px); /* Slight lift effect */
  }

  .nav-button:disabled {
    background-color: #555; /* Muted color when disabled */
    color: #bbb;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
  }

  /* Accessible hiding for screen readers */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
</style>
</head>
<body>
<div class="presentation-container">
  <div class="slides-wrapper">
    <!-- Slides will be dynamically injected here by JavaScript -->
  </div>
</div>

<div class="navigation-buttons">
  <button id="prevBtn" class="nav-button" aria-label="Previous Slide" disabled>Previous</button>
  <button id="nextBtn" class="nav-button" aria-label="Next Slide">Next</button>
</div>

<script>
  // Raw JSON content embedded directly into the script for self-containment
  const slideContentData = JSON.parse(`
    {
      "style": "energetic",
      "all_slides_content": [
        "# Monster Energy: Brand Overview\\n- Founded in 2002, based in Corona, California.\\n- Established as a leading global energy drink brand.\\n- Recognized for its distinctive branding and aggressive marketing.\\n- Offers a wide array of energy drink formulations.\\n- The Coca-Cola Company holds a significant 19% ownership stake.",
        "# Financial Performance and Market Position\\n- Achieved an impressive $7.1 billion in revenue in 2024.\\n- Reported a strong $1.7 billion in profit for the same year.\\n- Commands approximately 35% of the global energy drink market.\\n- Maintains consistent sales growth, around 10% annually.\\n- Stands as a dominant force, challenging market leader Red Bull.",
        "# Bar Chart: Global Energy Drink Market Share\\n- Red Bull: 43\\n- Monster Energy: 35\\n- Rockstar Energy: 8\\n- 5-Hour Energy: 4\\n- Other Brands: 10\\n\\n\`\`\`bar\\nRed Bull: 43\\nMonster Energy: 35\\nRockstar Energy: 8\\n5-Hour Energy: 4\\nOther Brands: 10\\n\`\`\`",    
        "# Global Presence and Product Diversification\\n- Products are distributed across more than 140 countries worldwide.\\n- Boasts an extensive portfolio with over 30 unique flavors.\\n- Continues to introduce new products and beverage categories.\\n- Strong international marketing drives brand recognition and sales.\\n- Adapting offerings to suit diverse regional consumer preferences.",
        "# Strategic Alliances and Future Growth\\n- Benefiting from strategic partnership with The Coca-Cola Company.\\n- Sustaining robust sales growth at approximately 10% per year.\\n- Focused on expanding market penetration in emerging economies.\\n- Continued innovation in product development and branding.\\n- Leveraging strong brand loyalty for long-term global leadership."
      ]
    }
  `);

  const slidesWrapper = document.querySelector('.slides-wrapper');
  let currentSlideIndex = 0;
  const emojiBullet = '⚡ '; // Chosen emoji for "energetic" style

  // Process and create slide elements from the input markdown content
  slideContentData.all_slides_content.forEach((content) => {
    const slideDiv = document.createElement('div');
    slideDiv.classList.add('slide');

    const barChartRegex = /```bar\n([\s\S]+?)\n```/;
    const barChartMatch = content.match(barChartRegex);

    let slideTitle = '';
    const h1Match = content.match(/^#\s(.+)$/m);
    if (h1Match) {
      slideTitle = h1Match[1].trim();
      slideDiv.innerHTML += `<h1>${slideTitle}</h1>`; // Add H1 to the slide
    }

    if (barChartMatch) {
      // If a bar chart is present, create the bar chart container
      // and store its raw data for lazy rendering.
      // Per instructions, for bar chart slides, no other content (like bullet lists) is included.
      const barChartData = barChartMatch[1].trim();
      const barChartContainer = document.createElement('div');
      barChartContainer.classList.add('bar-chart');
      barChartContainer.setAttribute('role', 'img');
      // Use the slide's title for a descriptive aria-label
      barChartContainer.setAttribute('aria-label', `${slideTitle || 'Untitled'} market share chart.`);
      slideDiv.appendChild(barChartContainer);
      slideDiv.dataset.barChartData = barChartData; // Store raw data for JS to parse later
    } else {
      // For regular slides, parse list items (bullet points)
      const lines = content.split('\n').map(line => line.trim()).filter(line => line.length > 0);
      let listHtml = '<ul>';
      let hasListItems = false;

      lines.forEach(line => {
        // Only process lines that are list items and not the H1 (which is already added)
        if (line.startsWith('- ') && !line.startsWith('# ')) {
          listHtml += `<li>${emojiBullet}${line.substring(2)}</li>`;
          hasListItems = true;
        }
        // Additional markdown parsing for other elements like paragraphs can be added here
        // if the input markdown structure becomes more complex than H1 + List for non-chart slides.
      });

      if (hasListItems) {
        listHtml += '</ul>';
        slideDiv.innerHTML += listHtml;
      }
    }
    slidesWrapper.appendChild(slideDiv);
  });

  const slides = document.querySelectorAll('.slide');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const MIN_VISIBLE_PERCENT = 1.5; // Minimum visible width for a bar with a non-zero value

  /**
   * Renders a bar chart into the given container element.
   * This function is idempotent: it will not re-render if already marked as rendered.
   * @param {HTMLElement} chartElement The div.bar-chart element to render into.
   */
  function renderBarChart(chartElement) {
    if (chartElement.dataset.rendered === '1') {
      console.info('Bar chart already rendered, skipping:', chartElement);
      return; // Prevent duplicate rendering
    }

    const rawData = chartElement.parentNode.dataset.barChartData;
    if (!rawData) {
      chartElement.innerHTML = '<p style="color:#aaa; text-align:center;">No chart data found.</p>';
      console.warn('No bar chart data found for element:', chartElement);
      chartElement.dataset.rendered = '1';
      return;
    }

    const lines = rawData.split('\n').map(line => line.trim()).filter(line => line.length > 0);
    const chartData = [];
    let maxValue = 0; // Initialize maxValue to 0, handles all non-positive values gracefully

    console.info('Attempting to parse bar chart data:', lines);

    lines.forEach((line) => {
      const parts = line.split(':', 1); // Split only on the first colon
      if (parts.length === 0 || parts[0].trim() === '') {
        console.warn(`Skipping invalid bar chart line (empty label): "${line}"`);
        return;
      }
      if (line.indexOf(':') === -1) {
        console.warn(`Skipping invalid bar chart line (missing colon for value): "${line}"`);
        return;
      }

      const label = parts[0].trim();
      const valueStr = line.substring(line.indexOf(':') + 1).trim();
      // Replace commas to correctly parse numbers with thousands separators
      const value = parseFloat(valueStr.replace(/,/g, ''));

      if (isNaN(value)) {
        console.warn(`Skipping invalid bar chart line (non-numeric value): "${line}"`);
        return;
      }

      chartData.push({ label, value });
      maxValue = Math.max(maxValue, value); // Find the maximum value
    });

    if (chartData.length === 0) {
      chartElement.innerHTML = '<p style="color:#aaa; text-align:center;">No valid chart data to display.</p>';
      console.warn('No valid bar chart data could be parsed from input.');
      chartElement.dataset.rendered = '1';
      return;
    }

    console.info(`Bar chart parsed successfully. Maximum value found: ${maxValue}`);

    chartElement.innerHTML = ''; // Clear any loading message or previous content
    chartData.forEach(item => {
      // Calculate width: if maxValue is 0 or negative (all values were <=0), width is 0.
      // Otherwise, calculate percentage, ensuring tiny positive values meet MIN_VISIBLE_PERCENT.
      const widthPercent = (maxValue > 0) ? (item.value / maxValue) * 100 : 0;
      const finalWidth = item.value > 0 ? Math.max(widthPercent, MIN_VISIBLE_PERCENT) : 0;

      const barRow = document.createElement('div');
      barRow.classList.add('bar-row');
      // Add a tooltip for enhanced UX and accessibility
      barRow.setAttribute('title', `${item.label} — ${item.value.toLocaleString()}`);

      const barLabel = document.createElement('span');
      barLabel.classList.add('bar-label');
      barLabel.textContent = item.label;

      const barTrack = document.createElement('div');
      barTrack.classList.add('bar-track');

      const barFill = document.createElement('div');
      barFill.classList.add('bar-fill');
      barFill.style.width = `${finalWidth}%`; // Set width for animation

      const barValue = document.createElement('span');
      barValue.classList.add('bar-value');
      barValue.textContent = item.value.toLocaleString(); // Format number for display

      barFill.appendChild(barValue);
      barTrack.appendChild(barFill);
      barRow.appendChild(barLabel);
      barRow.appendChild(barTrack);
      chartElement.appendChild(barRow);
    });
    chartElement.dataset.rendered = '1'; // Mark as rendered
  }

  /**
   * Displays a specific slide and manages navigation button states.
   * Lazily renders bar charts if the active slide contains one and it hasn't been rendered yet.
   * @param {number} index The index of the slide to display.
   */
  function showSlide(index) {
    if (index < 0 || index >= slides.length) {
      return; // Do nothing if index is out of bounds
    }

    // Hide all slides
    slides.forEach(slide => {
      slide.classList.remove('active');
      slide.setAttribute('aria-hidden', 'true'); // Hide from screen readers
    });

    // Show the active slide
    const activeSlide = slides[index];
    activeSlide.classList.add('active');
    activeSlide.setAttribute('aria-hidden', 'false'); // Make visible to screen readers
    currentSlideIndex = index;

    // Update navigation buttons' disabled state
    prevBtn.disabled = (currentSlideIndex === 0);
    nextBtn.disabled = (currentSlideIndex === slides.length - 1);

    // Render bar chart if the active slide has one and it's not yet rendered
    const barChartContainer = activeSlide.querySelector('.bar-chart');
    if (barChartContainer && !barChartContainer.dataset.rendered) {
      // A small timeout allows the slide to become visible and layout to settle
      // before the bar chart's width transitions are applied.
      setTimeout(() => renderBarChart(barChartContainer), 100);
    }
  }

  // Event Listeners for navigation buttons
  prevBtn.addEventListener('click', () => showSlide(currentSlideIndex - 1));
  nextBtn.addEventListener('click', () => showSlide(currentSlideIndex + 1));

  // Initial display: show the first slide when the page loads
  showSlide(0);

  // Keyboard navigation (Arrow keys)
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') {
      showSlide(currentSlideIndex + 1);
    } else if (e.key === 'ArrowLeft') {
      showSlide(currentSlideIndex - 1);
    }
  });

</script>
</body>
</html>